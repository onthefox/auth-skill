Rule ID,Category,Rule,Severity,Description,Implementation,Code Example,Mistake to Avoid,Testing Method
AUTH001,Token Storage,Never store JWT in localStorage for sensitive apps,Critical,localStorage is vulnerable to XSS,Use httpOnly cookies or in-memory storage,cookies: { httpOnly: true secure: true sameSite: 'strict' },Using localStorage for auth tokens,Manual code review
AUTH002,Token Expiry,Access tokens must expire within 60 minutes,Critical,Short-lived tokens limit damage from theft,set exp to 15-60 minutes,jwt.sign(payload secret { expiresIn: '15m' }),Long-lived access tokens,Pentest token theft scenario
AUTH003,Refresh Tokens,Implement refresh token rotation,High,Single-use refresh tokens prevent reuse,Generate new refresh token on each use,Store used tokens in blacklist,Reusing same refresh token,Test token replay attack
AUTH004,Token Validation,Always validate JWT signature,Critical,Prevents token tampering,Use verified library with proper issuer check,jwt.verify(token publicKey { issuer: 'https://auth.example.com' }),Accepting unsigned tokens,Fuzz testing with modified tokens
AUTH005,HTTPS Only,Transmit tokens only over HTTPS,Critical,Prevents man-in-the-middle attacks,Enforce HTTPS redirect HSTS,app.use((req res next) => { if (!req.secure) res.redirect('https://...') }),Sending tokens over HTTP,Network sniffing test
AUTH006,Password Hashing,Use Argon2id or bcrypt,Critical,Weak hashing allows brute force,Use argon2 or bcrypt with cost factor,await bcrypt.hash(password 12),Using MD5/SHA1 for passwords,Benchmark hash cracking time
AUTH007,Rate Limiting,Implement login rate limiting,High,Prevents brute force attacks,Use express-rate-limit or similar,limiter: rateLimit({ windowMs: 15*60*1000 max: 5 }),No rate limiting on auth endpoints,Load test with many requests
AUTH008,CSRF Protection,Use anti-CSRF tokens for state-changing ops,High,Prevents cross-site request forgery,Implement double-submit cookie pattern,res.cookie('XSRF-TOKEN' token) and validate header,Missing CSRF on forms/APIs,Test CSRF attack scenario
AUTH009,Session Fixation,Regenerate session ID after login,High,Prevents session fixation attacks,Destroy old session create new one,req.session.regenerate(() => { req.session.userId = user.id }),Keeping same session ID post-auth,Test session fixation attack
AUTH010,Error Messages,Use generic auth error messages,Medium,Prevents user enumeration,Return same error for invalid email/password,res.status(401).json({ error: 'Invalid credentials' }),Saying 'user not found' vs 'wrong password',Test for user enumeration
AUTH011,Password Reset,Single-use reset tokens with short expiry,High,Prevents token reuse attacks,Generate crypto token set 15min expiry,db.passwordResets.create({ token: crypto.randomBytes(32) expiresAt: Date.now() + 900000 }),Reusable or long-lived reset tokens,Test token reuse after first use
AUTH012,MFA Implementation,Require MFA for sensitive operations,High,Adds second factor of authentication,Implement TOTP or WebAuthn,await speakeasy.generateSecret({ name: 'MyApp' issuer: 'User' }),Optional MFA for admin actions,Test without MFA bypass
AUTH013,Scope Validation,Validate OAuth2 scopes server-side,High,Prevents privilege escalation,Check scopes before resource access,if (!token.scopes.includes('users:read')) throw ForbiddenError,Trusting client-requested scopes,Test with elevated scopes
AUTH014,Redirect URI,Whitelist exact redirect URIs,Critical,Prevents open redirect attacks,Store allowed URIs validate exact match,if (!allowedRedirects.includes(redirectUri)) throw InvalidRedirectError,Allowing wildcard or partial matches,Test with malicious redirect URI
AUTH015,State Parameter,Always use state parameter in OAuth2,High,Prevents CSRF in OAuth flow,Generate random state validate on callback,const state = crypto.randomBytes(16).toString('hex'),Skipping state parameter,Test OAuth CSRF attack
AUTH016,PKCE,Require PKCE for public clients,Critical,Prevents authorization code interception,Generate code_verifier and code_challenge,PKCE is required for SPAs and mobile,Test code interception attack
AUTH017,CORS Configuration,Restrict CORS origins for auth endpoints,High,Prevents cross-origin attacks,Whitelist specific origins not *,cors({ origin: ['https://app.example.com'] credentials: true }),Using CORS * for auth endpoints,Test cross-origin requests
AUTH018,Security Headers,Set security headers on all responses,High,Prevents various attacks,Use helmet middleware or manual headers,app.use(helmet({ contentSecurityPolicy: { directives: { defaultSrc: ["'self'"] } } })),Missing security headers,Security header scanner test
AUTH019,Logging,Log auth events without sensitive data,Medium,Audit trail without exposing secrets,Log event type timestamp user ID not tokens,winston.info('Login attempt' { userId userId success }),Logging passwords or tokens,Audit log review
AUTH020,Account Lockout,Implement progressive account lockout,Medium,Prevents brute force while allowing legitimate users,Lock after N failures exponential backoff,after 5 failures lock 15min after 10 failures lock 1 hour,Permanent lockout or no lockout,Test brute force scenario
AUTH021,Session Invalidation,Invalidate sessions on password change,Critical,Prevents continued access after credential change,Delete all user sessions on password change,await db.sessions.deleteMany({ userId }),Not invalidating existing sessions,Test with old session after password change
AUTH022,Concurrent Sessions,Limit concurrent sessions per user,Medium,Reduces credential sharing risk,Track active sessions enforce limit,if (activeSessions.length >= MAX_SESSIONS) deny(),Unlimited concurrent sessions,Test with multiple simultaneous logins
AUTH023,Token Audience,Validate audience claim in JWT,High,Prevents token confusion attacks,Check aud matches your API,if (payload.aud !== 'https://api.example.com') throw InvalidAudienceError,Not validating audience,Test with token from different service
AUTH024,Issuer Validation,Validate issuer claim in JWT,High,Prevents token substitution,Check iss matches expected issuer,if (payload.iss !== 'https://auth.example.com') throw InvalidIssuerError,Trusting any issuer,Test with token from different issuer
AUTH025,Algorithm Verification,Verify JWT algorithm is asymmetric,High,Prevents algorithm confusion attacks,Require RS256 verify in header,jwt.verify(token publicKey { algorithms: ['RS256'] }),Accepting HS256 when RS256 expected,Test algorithm substitution attack
